{
  "file_path": "SPECS/SIB/INTENT/TASK_ARCHIVE/13_B5_VR004_VR005_Ordering_Validation/Summary_of_Work.md",
  "n_spec": 7,
  "n_func": 3,
  "intent_atoms": [
    {
      "type": "user_story",
      "description": "Flag media boxes that appear before the required ftyp declaration during live parsing (VR-004).",
      "source_line": null
    },
    {
      "type": "user_story",
      "description": "Warn when mdat precedes moov outside of recognized streaming layouts (VR-005).",
      "source_line": null
    },
    {
      "type": "acceptance_criteria",
      "description": "Implement stateful ordering rules in BoxValidator to track file-type and movie box sequencing.",
      "source_line": null
    },
    {
      "type": "acceptance_criteria",
      "description": "Expand live pipeline tests to cover VR-004/VR-005 violations and permitted streaming exceptions.",
      "source_line": null
    },
    {
      "type": "invariant",
      "description": "Box ordering must respect ftyp before other boxes except allowed streaming layouts.",
      "source_line": null
    },
    {
      "type": "architectural_decision",
      "description": "Centralise MP4 container box detection through FourCharContainerCode enum instead of string literals.",
      "source_line": null
    },
    {
      "type": "architectural_decision",
      "description": "Use MediaAndIndexBoxCode enum to strongly type mdat, sidx, styp and replace raw strings in validators.",
      "source_line": null
    }
  ],
  "functional_units": [
    {
      "name": "BoxValidator Ordering Rules",
      "description": "Validates the sequence of MP4 boxes during live parsing, flagging media boxes before ftyp (VR-004) and mdat before moov outside streaming layouts (VR-005).",
      "source_line": null
    },
    {
      "name": "FourCharContainerCode Enum",
      "description": "Centralised enumeration for MP4 container box detection used in traversal logic.",
      "source_line": null
    },
    {
      "name": "MediaAndIndexBoxCode Enum",
      "description": "Strongly typed enumeration for media and index boxes (mdat, sidx, styp) with conversion helpers and category sets.",
      "source_line": null
    }
  ],
  "metadata": {
    "file_size_bytes": 1500,
    "line_count": 49
  }
}
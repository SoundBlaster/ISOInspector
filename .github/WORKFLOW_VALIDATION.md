# GitHub Actions Workflow Validation

## –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ workflow —Ñ–∞–π–ª–∞—Ö

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞–Ω–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö YAML —Ñ–∞–π–ª–æ–≤ –≤ main –≤–µ—Ç–∫—É.

## üõ°Ô∏è –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (Pre-commit —Ö—É–∫–∏)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pre-commit
pip install pre-commit

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ö—É–∫–æ–≤ –¥–ª—è commit –∏ push
pre-commit install --hook-type pre-commit --hook-type pre-push

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
pre-commit run --all-files
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å YAML –¥–ª—è –≤—Å–µ—Ö `.yml` –∏ `.yaml` —Ñ–∞–π–ª–æ–≤
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è `.github/workflows/*.yml`
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>1MB)
- ‚úÖ Trailing whitespace
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (newline)

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º `git commit`

### 2. CI –≤–∞–ª–∏–¥–∞—Ü–∏—è (GitHub Actions)

**Workflow:** `.github/workflows/validate-workflows.yml`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ YAML —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —á–µ—Ä–µ–∑ PyYAML
- ‚úÖ GitHub Actions —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `actionlint`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ best practices

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Pull Request —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ `.github/workflows/`
- –ü—Ä–∏ push –≤ main –≤–µ—Ç–∫—É

### 3. –†—É—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
python3 -c "import yaml; yaml.safe_load(open('.github/workflows/my-workflow.yml'))"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ workflow —Ñ–∞–π–ª—ã
for file in .github/workflows/*.yml; do
  echo "Checking: $file"
  python3 -c "import yaml; yaml.safe_load(open('$file'))" || exit 1
done

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å actionlint (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
actionlint
```

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º workflow —Ñ–∞–π–ª–æ–≤

- [ ] –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è YAML –ø—Ä–æ–π–¥–µ–Ω–∞
- [ ] Pre-commit —Ö—É–∫–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –§–∞–π–ª –ø—Ä–æ–≤–µ—Ä–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç—Å—Ç—É–ø–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ spaces, –Ω–µ tabs –≤ YAML)
- [ ] Python heredoc –±–ª–æ–∫–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ workflow –≤—ã–ø–æ–ª–Ω–µ–Ω (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

## üîß –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã –≤ heredoc –±–ª–æ–∫–∞—Ö

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```yaml
run: |
  python3 << 'EOF'
import sys  # –ù–µ—Ç –æ—Ç—Å—Ç—É–ø–∞!
print("hello")
EOF
```

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```yaml
run: |
  python3 << 'EOF'
  import sys  # –û—Ç—Å—Ç—É–ø —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –±–ª–æ–∫–æ–º run
  print("hello")
  EOF
```

### 2. –°–º–µ—à–∏–≤–∞–Ω–∏–µ tabs –∏ spaces

- YAML —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ spaces
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä: 2 spaces –¥–ª—è –æ—Ç—Å—Ç—É–ø–æ–≤ –≤ YAML

### 3. –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π YAML —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:
```bash
yamllint .github/workflows/your-file.yml
```

## üöÄ Best Practices

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ IDE —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π YAML**
   - VSCode: YAML extension –æ—Ç Red Hat
   - IntelliJ IDEA: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
   - Vim: vim-yaml –ø–ª–∞–≥–∏–Ω

2. **–í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ**
   ```json
   // VSCode settings.json
   {
     "yaml.schemas": {
       "https://json.schemastore.org/github-workflow.json": ".github/workflows/*.yml"
     }
   }
   ```

3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ workflow –ª–æ–∫–∞–ª—å–Ω–æ**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [act](https://github.com/nektos/act) –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ GitHub Actions
   ```bash
   act -l  # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö jobs
   act pull_request  # –ó–∞–ø—É—Å—Ç–∏—Ç—å PR workflows
   ```

4. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ feature branch –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ workflows**
   - –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –Ω–∞–ø—Ä—è–º—É—é –≤ main
   - –°–æ–∑–¥–∞–≤–∞–π—Ç–µ PR –¥–ª—è review
   - –î–æ–∂–¥–∏—Ç–µ—Å—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è CI –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [actionlint](https://github.com/rhysd/actionlint) - Linter –¥–ª—è GitHub Actions
- [pre-commit hooks](https://pre-commit.com/) - Framework –¥–ª—è git hooks
- [act](https://github.com/nektos/act) - –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ GitHub Actions

## üêõ –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 2025-11-16: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ performance-regression.yml
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã –≤ Python heredoc –±–ª–æ–∫–∞—Ö (—Å—Ç—Ä–æ–∫–∞ 63)
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –≤—Å–µ—Ö heredoc –±–ª–æ–∫–æ–≤
- **–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:**
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ YAML –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ pre-commit hooks
  - –°–æ–∑–¥–∞–Ω workflow validate-workflows.yml
  - –ù–∞–ø–∏—Å–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üí° –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞

```bash
# –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º workflow —Ñ–∞–π–ª–∞:
python3 -c "import yaml; yaml.safe_load(open('.github/workflows/FILE.yml'))"

# –û–±–Ω–æ–≤–∏—Ç—å pre-commit —Ö—É–∫–∏:
pre-commit autoupdate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
pre-commit run --all-files

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ YAML:
pre-commit run check-yaml --all-files
```
